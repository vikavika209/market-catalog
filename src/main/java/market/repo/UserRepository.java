package market.repo;

import market.domain.User;

import java.io.IOException;
import java.util.Optional;

/**
 * Репозиторий для управления объектами {@link User}.
 * <p>
 * Определяет абстрактный интерфейс доступа к данным пользователей.
 * Реализация может хранить данные в памяти, в CSV-файле или в базе данных.
 * <p>
 * Репозиторий изолирует слой бизнес-логики (сервисы) от конкретного способа хранения данных.
 */
public interface UserRepository {
    /**
     * Ищет пользователя по имени (логину).
     *
     * @param username имя пользователя
     * @return {@link Optional} с найденным пользователем или {@link Optional#empty()},
     *         если пользователь с таким именем не найден
     */
    Optional<User> findByUsername(String username);

    /**
     * Сохраняет или обновляет информацию о пользователе в хранилище.
     * <p>
     * Если пользователь с таким именем уже существует, его данные обновляются;
     * иначе создаётся новая запись.
     *
     * @param user объект пользователя для сохранения
     */
    void saveUser(User user);

    /**
     * Проверяет существование пользователя с указанным именем.
     *
     * @param username имя пользователя для проверки
     * @return {@code true}, если пользователь с таким именем существует; {@code false} — иначе
     */
    boolean exists(String username);

    /**
     * Загружает данные пользователей из внешнего источника (например, CSV-файла).
     *
     * @throws IOException если произошла ошибка при чтении данных
     */
    void load() throws IOException;

    /**
     * Сохраняет текущее состояние данных пользователей в постоянное хранилище.
     *
     * @throws IOException если произошла ошибка при записи данных
     */
    void persist() throws IOException;
}
